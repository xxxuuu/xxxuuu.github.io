import"./hoisted.CoLf1DwL.js";import"./hoisted.CNw43vkv.js";function h(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g()}function g(){const t=document.querySelector(".toc-container"),c=document.querySelector(".notion-content");if(!t||!c)return;const a=c.querySelectorAll("h1, h2, h3");if(a.length===0){t.classList.add("toc-empty");return}const n=Array.from(a).map((d,i)=>{const e=d;if(!e.id){const l=(e.textContent||"").toLowerCase().replace(/[^\w\u4e00-\u9fa5]+/g,"-").replace(/^-+|-+$/g,"");e.id=l||`heading-${i}`}return{id:e.id,text:e.textContent||"",level:parseInt(d.tagName[1]),element:e}}),r=v(n),s=t.querySelector(".toc-nav");s&&(s.innerHTML=r),y(t),x(t),L(t),setTimeout(()=>{k(n)},0)}function v(t){if(t.length===0)return"";const c=Math.min(...t.map(e=>e.level)),a=t.map(e=>e.text.length),n=Math.min(...a),s=Math.max(...a)-n||1,d={};t.forEach(e=>{const o=e.level-c;if(!d[o]){const l=44-o*8,u=l-12;d[o]={min:u,max:l}}});let i='<ul class="toc-list">';return t.forEach(e=>{const o=e.level-c,l=o*1.125,u=(e.text.length-n)/s,f=Math.sqrt(u),m=d[o],p=Math.round(m.min+f*(m.max-m.min));i+=`
      <li class="toc-item toc-level-${e.level}" style="margin-left: ${l}rem;" data-bar-width="${p}">
        <a href="#${e.id}" class="toc-link" data-target="${e.id}">
          ${w(e.text)}
        </a>
      </li>
    `}),i+="</ul>",i}function w(t){const c=document.createElement("div");return c.textContent=t,c.innerHTML}function y(t){t.querySelectorAll(".toc-item").forEach(a=>{const n=a.getAttribute("data-bar-width"),r=a.querySelector(".toc-link");n&&r&&r.style.setProperty("--bar-width",`${n}px`)})}function L(t){const c=document.querySelector(".page-main");if(!c)return;const a=()=>{const r=c.getBoundingClientRect(),s=t,d=r.top,e=Math.max(100,d+20);s.style.top=`${e}px`;const o=window.innerHeight-e-20;s.style.maxHeight=`${o}px`};let n=!1;window.addEventListener("scroll",()=>{n||(window.requestAnimationFrame(()=>{a(),n=!1}),n=!0)},{passive:!0}),window.addEventListener("resize",()=>{n||(window.requestAnimationFrame(()=>{a(),n=!1}),n=!0)},{passive:!0}),requestAnimationFrame(()=>{a()})}function x(t){t.addEventListener("click",c=>{const n=c.target.closest(".toc-link");if(!n)return;c.preventDefault();const r=n.getAttribute("data-target");if(!r)return;const s=document.getElementById(r);if(!s)return;const e=s.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:e,behavior:"smooth"}),history.pushState(null,"",`#${r}`)})}function k(t,c){let a="";const n=()=>{const s=window.innerHeight,d=s/3;let i="",e=1/0;for(const o of t){const u=o.element.getBoundingClientRect(),f=Math.abs(u.top-d);u.top<=s&&u.top>=-u.height&&f<e&&(e=f,i=o.id)}if(!i){for(let o=t.length-1;o>=0;o--)if(t[o].element.getBoundingClientRect().top<0){i=t[o].id;break}}if(!i&&t.length>0&&(i=t[0].id),i!==a&&(a=i,document.querySelectorAll(".toc-container .toc-link").forEach(l=>{l.classList.remove("toc-active")}),i)){const l=document.querySelector(`.toc-container .toc-link[data-target="${i}"]`);l&&l.classList.add("toc-active")}};let r=!1;window.addEventListener("scroll",()=>{r||(window.requestAnimationFrame(()=>{n(),r=!1}),r=!0)},{passive:!0}),requestAnimationFrame(()=>{n()})}typeof window<"u"&&h();h();
