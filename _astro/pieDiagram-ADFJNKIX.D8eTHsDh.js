import{Q as S,T as z,aB as j,_ as p,g as q,s as H,a as K,b as Q,t as Z,q as J,l as F,c as X,F as Y,K as ee,a4 as te,e as ae,z as re,H as ne}from"./mermaid.core.CtRPnIEe.js";import{p as ie}from"./chunk-4BX2VUAB.DOpF9h2V.js";import{p as se}from"./treemap-KMMF4GRG.ChM2Lv6Y.js";import{d as I}from"./arc.D4tGJPXg.js";import{o as le}from"./ordinal.BYWQX77i.js";import"./hoisted.CoLf1DwL.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./min.BJHkt5xY.js";import"./_baseUniq.CBBieZCC.js";import"./init.Gi6I4Gst.js";function oe(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function ce(e){return e}function ue(){var e=ce,t=oe,a=null,n=S(0),i=S(z),r=S(0);function l(l){var s,o,p,c,u,d=(l=j(l)).length,f=0,h=new Array(d),g=new Array(d),m=+n.apply(this,arguments),S=Math.min(z,Math.max(-z,i.apply(this,arguments)-m)),x=Math.min(Math.abs(S)/d,r.apply(this,arguments)),w=x*(S<0?-1:1);for(s=0;s<d;++s)(u=g[h[s]=s]=+e(l[s],s,l))>0&&(f+=u);for(null!=t?h.sort(function(e,a){return t(g[e],g[a])}):null!=a&&h.sort(function(e,t){return a(l[e],l[t])}),s=0,p=f?(S-d*w)/f:0;s<d;++s,m=c)o=h[s],c=m+((u=g[o])>0?u*p:0)+w,g[o]={data:l[o],index:s,value:u,startAngle:m,endAngle:c,padAngle:x};return g}return l.value=function(t){return arguments.length?(e="function"==typeof t?t:S(+t),l):e},l.sortValues=function(e){return arguments.length?(t=e,a=null,l):t},l.sort=function(e){return arguments.length?(a=e,t=null,l):a},l.startAngle=function(e){return arguments.length?(n="function"==typeof e?e:S(+e),l):n},l.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:S(+e),l):i},l.padAngle=function(e){return arguments.length?(r="function"==typeof e?e:S(+e),l):r},l}var pe=ne.pie,G={sections:new Map,showData:!1},T=G.sections,N=G.showData,de=structuredClone(pe),ge=p(()=>structuredClone(de),"getConfig"),fe=p(()=>{T=new Map,N=G.showData,re()},"clear"),me=p(({label:e,value:t})=>{if(t<0)throw new Error(`"${e}" has invalid value: ${t}. Negative values are not allowed in pie charts. All slice values must be >= 0.`);T.has(e)||(T.set(e,t),F.debug(`added new section: ${e}, with value: ${t}`))},"addSection"),he=p(()=>T,"getSections"),ve=p(e=>{N=e},"setShowData"),Se=p(()=>N,"getShowData"),L={getConfig:ge,clear:fe,setDiagramTitle:J,getDiagramTitle:Z,setAccTitle:Q,getAccTitle:K,setAccDescription:H,getAccDescription:q,addSection:me,getSections:he,setShowData:ve,getShowData:Se},xe=p((e,t)=>{ie(e,t),t.setShowData(e.showData),e.sections.map(t.addSection)},"populateDb"),ye={parse:p(async e=>{const t=await se("pie",e);F.debug(t),xe(t,L)},"parse")},we=p(e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`,"getStyles"),Ae=we,De=p(e=>{const t=[...e.values()].reduce((e,t)=>e+t,0),a=[...e.entries()].map(([e,t])=>({label:e,value:t})).filter(e=>e.value/t*100>=1).sort((e,t)=>t.value-e.value);return ue().value(e=>e.value)(a)},"createPieArcs"),Ce=p((e,t,a,n)=>{F.debug("rendering pie chart\n"+e);const i=n.db,r=X(),l=Y(i.getConfig(),r.pie),s=18,o=450,p=o,c=ee(t),u=c.append("g");u.attr("transform","translate(225,225)");const{themeVariables:d}=r;let[f]=te(d.pieOuterStrokeWidth);f??=2;const h=l.textPosition,g=Math.min(p,o)/2-40,m=I().innerRadius(0).outerRadius(g),S=I().innerRadius(g*h).outerRadius(g*h);u.append("circle").attr("cx",0).attr("cy",0).attr("r",g+f/2).attr("class","pieOuterCircle");const x=i.getSections(),w=De(x),y=[d.pie1,d.pie2,d.pie3,d.pie4,d.pie5,d.pie6,d.pie7,d.pie8,d.pie9,d.pie10,d.pie11,d.pie12];let v=0;x.forEach(e=>{v+=e});const C=w.filter(e=>"0"!==(e.data.value/v*100).toFixed(0)),T=le(y);u.selectAll("mySlices").data(C).enter().append("path").attr("d",m).attr("fill",e=>T(e.data.label)).attr("class","pieCircle"),u.selectAll("mySlices").data(C).enter().append("text").text(e=>(e.data.value/v*100).toFixed(0)+"%").attr("transform",e=>"translate("+S.centroid(e)+")").style("text-anchor","middle").attr("class","slice"),u.append("text").text(i.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const $=[...x.entries()].map(([e,t])=>({label:e,value:t})),A=u.selectAll(".legend").data($).enter().append("g").attr("class","legend").attr("transform",(e,t)=>"translate(216,"+(22*t-22*$.length/2)+")");A.append("rect").attr("width",s).attr("height",s).style("fill",e=>T(e.label)).style("stroke",e=>T(e.label)),A.append("text").attr("x",22).attr("y",14).text(e=>i.getShowData()?`${e.label} [${e.value}]`:e.label);const D=512+Math.max(...A.selectAll("text").nodes().map(e=>e?.getBoundingClientRect().width??0));c.attr("viewBox",`0 0 ${D} 450`),ae(c,o,D,l.useMaxWidth)},"draw"),$e={draw:Ce},Oe={parser:ye,db:L,renderer:$e,styles:Ae};export{Oe as diagram};