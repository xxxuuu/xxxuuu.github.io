import{_ as w,F as ee,G as te,K as de,e as he,l as Z,b8 as P,d as j,b as ue,a as pe,q as fe,t as me,g as ge,s as ye,H as Se,b9 as ve,z as xe}from"./mermaid.core.CtRPnIEe.js";import{s as be}from"./chunk-QN33PNHL.C8y3j9Q_.js";import{p as we}from"./chunk-4BX2VUAB.DOpF9h2V.js";import{p as Ce}from"./treemap-KMMF4GRG.ChM2Lv6Y.js";import{b as I}from"./defaultLocale.C4B-KCzX.js";import{o as U}from"./ordinal.BYWQX77i.js";import"./hoisted.CoLf1DwL.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./min.BJHkt5xY.js";import"./_baseUniq.CBBieZCC.js";import"./init.Gi6I4Gst.js";function Te(e){var t=0,a=e.children,n=a&&a.length;if(n)for(;--n>=0;)t+=a[n].value;else t=1;e.value=t}function Le(){return this.eachAfter(Te)}function $e(e,t){let a=-1;for(const n of this)e.call(t,n,++a,this);return this}function Ae(e,t){for(var a,n,r=this,l=[r],s=-1;r=l.pop();)if(e.call(t,r,++s,this),a=r.children)for(n=a.length-1;n>=0;--n)l.push(a[n]);return this}function Fe(e,t){for(var a,n,r,l=this,s=[l],o=[],i=-1;l=s.pop();)if(o.push(l),a=l.children)for(n=0,r=a.length;n<r;++n)s.push(a[n]);for(;l=o.pop();)e.call(t,l,++i,this);return this}function ke(e,t){let a=-1;for(const n of this)if(e.call(t,n,++a,this))return n}function Ne(e){return this.eachAfter(function(t){for(var a=+e(t.data)||0,n=t.children,r=n&&n.length;--r>=0;)a+=n[r].value;t.value=a})}function Me(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function _e(e){for(var t=this,a=ze(t,e),n=[t];t!==a;)t=t.parent,n.push(t);for(var r=n.length;e!==a;)n.splice(r,0,e),e=e.parent;return n}function ze(e,t){if(e===t)return e;var a=e.ancestors(),n=t.ancestors(),r=null;for(e=a.pop(),t=n.pop();e===t;)r=e,e=a.pop(),t=n.pop();return r}function Ve(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function De(){return Array.from(this)}function Pe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Be(){var e=this,t=[];return e.each(function(a){a!==e&&t.push({source:a.parent,target:a})}),t}function*Re(){var e,t,a,n,r=this,l=[r];do{for(e=l.reverse(),l=[];r=e.pop();)if(yield r,t=r.children)for(a=0,n=t.length;a<n;++a)l.push(t[a])}while(l.length)}function J(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=He)):void 0===t&&(t=We);for(var a,n,r,l,s,o=new Y(e),i=[o];a=i.pop();)if((r=t(a.data))&&(s=(r=Array.from(r)).length))for(a.children=r,l=s-1;l>=0;--l)i.push(n=r[l]=new Y(r[l])),n.parent=a,n.depth=a.depth+1;return o.eachBefore(Oe)}function Ee(){return J(this).eachBefore(Ie)}function We(e){return e.children}function He(e){return Array.isArray(e)?e[1]:null}function Ie(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function Oe(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Y(e){this.data=e,this.depth=this.height=0,this.parent=null}function Ge(e){if("function"!=typeof e)throw new Error;return e}function O(){return 0}function G(e){return function(){return e}}function qe(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Xe(e,t,a,n,r){for(var l,s=e.children,o=-1,i=s.length,c=e.value&&(n-t)/e.value;++o<i;)(l=s[o]).y0=a,l.y1=r,l.x0=t,l.x1=t+=l.value*c}function je(e,t,a,n,r){for(var l,s=e.children,o=-1,i=s.length,c=e.value&&(r-a)/e.value;++o<i;)(l=s[o]).x0=t,l.x1=n,l.y0=a,l.y1=a+=l.value*c}Y.prototype=J.prototype={constructor:Y,count:Le,each:$e,eachAfter:Fe,eachBefore:Ae,find:ke,sum:Ne,sort:Me,path:_e,ancestors:Ve,descendants:De,leaves:Pe,links:Be,copy:Ee,[Symbol.iterator]:Re};var Ye=(1+Math.sqrt(5))/2;function Ke(e,t,a,n,r,l){for(var s,o,i,c,d,p,h,u,f,m,y,g=[],x=t.children,S=0,v=0,w=x.length,C=t.value;S<w;){i=r-a,c=l-n;do{d=x[v++].value}while(!d&&v<w);for(p=h=d,y=d*d*(m=Math.max(c/i,i/c)/(C*e)),f=Math.max(h/y,y/p);v<w;++v){if(d+=o=x[v].value,o<p&&(p=o),o>h&&(h=o),y=d*d*m,(u=Math.max(h/y,y/p))>f){d-=o;break}f=u}g.push(s={value:d,dice:i<c,children:x.slice(S,v)}),s.dice?Xe(s,a,n,r,C?n+=c*d/C:l):je(s,a,n,C?a+=i*d/C:r,l),C-=d,S=v}return g}const Ue=function e(t){function a(e,a,n,r,l){Ke(t,e,a,n,r,l)}return a.ratio=function(t){return e((t=+t)>1?t:1)},a}(Ye);function Ze(){var e=Ue,t=!1,a=1,n=1,r=[0],l=O,s=O,o=O,i=O,c=O;function d(e){return e.x0=e.y0=0,e.x1=a,e.y1=n,e.eachBefore(p),r=[0],t&&e.eachBefore(qe),e}function p(t){var a=r[t.depth],n=t.x0+a,d=t.y0+a,p=t.x1-a,h=t.y1-a;p<n&&(n=p=(n+p)/2),h<d&&(d=h=(d+h)/2),t.x0=n,t.y0=d,t.x1=p,t.y1=h,t.children&&(a=r[t.depth+1]=l(t)/2,n+=c(t)-a,d+=s(t)-a,(p-=o(t)-a)<n&&(n=p=(n+p)/2),(h-=i(t)-a)<d&&(d=h=(d+h)/2),e(t,n,d,p,h))}return d.round=function(e){return arguments.length?(t=!!e,d):t},d.size=function(e){return arguments.length?(a=+e[0],n=+e[1],d):[a,n]},d.tile=function(t){return arguments.length?(e=Ge(t),d):e},d.padding=function(e){return arguments.length?d.paddingInner(e).paddingOuter(e):d.paddingInner()},d.paddingInner=function(e){return arguments.length?(l="function"==typeof e?e:G(+e),d):l},d.paddingOuter=function(e){return arguments.length?d.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):d.paddingTop()},d.paddingTop=function(e){return arguments.length?(s="function"==typeof e?e:G(+e),d):s},d.paddingRight=function(e){return arguments.length?(o="function"==typeof e?e:G(+e),d):o},d.paddingBottom=function(e){return arguments.length?(i="function"==typeof e?e:G(+e),d):i},d.paddingLeft=function(e){return arguments.length?(c="function"==typeof e?e:G(+e),d):c},d}var ae=class{constructor(){this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.setAccTitle=ue,this.getAccTitle=pe,this.setDiagramTitle=fe,this.getDiagramTitle=me,this.getAccDescription=ge,this.setAccDescription=ye}static{w(this,"TreeMapDB")}getNodes(){return this.nodes}getConfig(){const e=Se,t=te();return ee({...e.treemap,...t.treemap??{}})}addNode(e,t){this.nodes.push(e),this.levels.set(e,t),0===t&&(this.outerNodes.push(e),this.root??=e)}getRoot(){return{name:"",children:this.outerNodes}}addClass(e,t){const a=this.classes.get(e)??{id:e,styles:[],textStyles:[]},n=t.replace(/\\,/g,"§§§").replace(/,/g,";").replace(/§§§/g,",").split(";");n&&n.forEach(e=>{ve(e)&&(a?.textStyles?a.textStyles.push(e):a.textStyles=[e]),a?.styles?a.styles.push(e):a.styles=[e]}),this.classes.set(e,a)}getClasses(){return this.classes}getStylesForClass(e){return this.classes.get(e)?.styles??[]}clear(){xe(),this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.root=void 0}};function ne(e){if(!e.length)return[];const t=[],a=[];return e.forEach(e=>{const n={name:e.name,children:"Leaf"===e.type?void 0:[]};for(n.classSelector=e?.classSelector,e?.cssCompiledStyles&&(n.cssCompiledStyles=[e.cssCompiledStyles]),"Leaf"===e.type&&void 0!==e.value&&(n.value=e.value);a.length>0&&a[a.length-1].level>=e.level;)a.pop();if(0===a.length)t.push(n);else{const e=a[a.length-1].node;e.children?e.children.push(n):e.children=[n]}"Leaf"!==e.type&&a.push({node:n,level:e.level})}),t}w(ne,"buildHierarchy");var Je=w((e,t)=>{we(e,t);const a=[];for(const a of e.TreemapRows??[])"ClassDefStatement"===a.$type&&t.addClass(a.className??"",a.styleText??"");for(const n of e.TreemapRows??[]){const e=n.item;if(!e)continue;const r=n.indent?parseInt(n.indent):0,l=Qe(e),s=e.classSelector?t.getStylesForClass(e.classSelector):[],o=s.length>0?s.join(";"):void 0,i={level:r,name:l,type:e.$type,value:e.value,classSelector:e.classSelector,cssCompiledStyles:o};a.push(i)}const n=ne(a),r=w((e,a)=>{for(const n of e)t.addNode(n,a),n.children&&n.children.length>0&&r(n.children,a+1)},"addNodesRecursively");r(n,0)},"populate"),Qe=w(e=>e.name?String(e.name):"","getItemName"),le={parser:{yy:void 0},parse:w(async e=>{try{const t=await Ce("treemap",e);Z.debug("Treemap AST:",t);const a=le.parser?.yy;if(!(a instanceof ae))throw new Error("parser.parser?.yy was not a TreemapDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.");Je(t,a)}catch(e){throw Z.error("Error parsing treemap:",e),e}},"parse")},et=10,B=10,q=25,tt=w((e,t,a,n)=>{const r=n.db,l=r.getConfig(),s=l.padding??et,o=r.getDiagramTitle(),i=r.getRoot(),{themeVariables:c}=te();if(!i)return;const d=o?30:0,p=de(t),h=l.nodeWidth?l.nodeWidth*B:960,u=l.nodeHeight?l.nodeHeight*B:500,f=h,m=u+d;let y;p.attr("viewBox",`0 0 ${f} ${m}`),he(p,m,f,l.useMaxWidth);try{const e=l.valueFormat||",";if("$0,0"===e)y=w(e=>"$"+I(",")(e),"valueFormat");else if(e.startsWith("$")&&e.includes(",")){const t=/\.\d+/.exec(e),a=t?t[0]:"";y=w(e=>"$"+I(","+a)(e),"valueFormat")}else if(e.startsWith("$")){const t=e.substring(1);y=w(e=>"$"+I(t||"")(e),"valueFormat")}else y=I(e)}catch(e){Z.error("Error creating format function:",e),y=I(",")}const g=U().range(["transparent",c.cScale0,c.cScale1,c.cScale2,c.cScale3,c.cScale4,c.cScale5,c.cScale6,c.cScale7,c.cScale8,c.cScale9,c.cScale10,c.cScale11]),x=U().range(["transparent",c.cScalePeer0,c.cScalePeer1,c.cScalePeer2,c.cScalePeer3,c.cScalePeer4,c.cScalePeer5,c.cScalePeer6,c.cScalePeer7,c.cScalePeer8,c.cScalePeer9,c.cScalePeer10,c.cScalePeer11]),S=U().range([c.cScaleLabel0,c.cScaleLabel1,c.cScaleLabel2,c.cScaleLabel3,c.cScaleLabel4,c.cScaleLabel5,c.cScaleLabel6,c.cScaleLabel7,c.cScaleLabel8,c.cScaleLabel9,c.cScaleLabel10,c.cScaleLabel11]);o&&p.append("text").attr("x",f/2).attr("y",d/2).attr("class","treemapTitle").attr("text-anchor","middle").attr("dominant-baseline","middle").text(o);const v=p.append("g").attr("transform",`translate(0, ${d})`).attr("class","treemapContainer"),C=J(i).sum(e=>e.value??0).sort((e,t)=>(t.value??0)-(e.value??0)),b=Ze().size([h,u]).paddingTop(e=>e.children&&e.children.length>0?q+B:0).paddingInner(s).paddingLeft(e=>e.children&&e.children.length>0?B:0).paddingRight(e=>e.children&&e.children.length>0?B:0).paddingBottom(e=>e.children&&e.children.length>0?B:0).round(!0)(C),$=b.descendants().filter(e=>e.children&&e.children.length>0),L=v.selectAll(".treemapSection").data($).enter().append("g").attr("class","treemapSection").attr("transform",e=>`translate(${e.x0},${e.y0})`);L.append("rect").attr("width",e=>e.x1-e.x0).attr("height",q).attr("class","treemapSectionHeader").attr("fill","none").attr("fill-opacity",.6).attr("stroke-width",.6).attr("style",e=>0===e.depth?"display: none;":""),L.append("clipPath").attr("id",(e,a)=>`clip-section-${t}-${a}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-12)).attr("height",q),L.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class",(e,t)=>`treemapSection section${t}`).attr("fill",e=>g(e.data.name)).attr("fill-opacity",.6).attr("stroke",e=>x(e.data.name)).attr("stroke-width",2).attr("stroke-opacity",.4).attr("style",e=>{if(0===e.depth)return"display: none;";const t=P({cssCompiledStyles:e.data.cssCompiledStyles});return t.nodeStyles+";"+t.borderStyles.join(";")}),L.append("text").attr("class","treemapSectionLabel").attr("x",6).attr("y",q/2).attr("dominant-baseline","middle").text(e=>0===e.depth?"":e.data.name).attr("font-weight","bold").attr("style",e=>{if(0===e.depth)return"display: none;";return"dominant-baseline: middle; font-size: 12px; fill:"+S(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"+P({cssCompiledStyles:e.data.cssCompiledStyles}).labelStyles.replace("color:","fill:")}).each(function(e){if(0===e.depth)return;const t=j(this),a=e.data.name;t.text(a);const n=e.x1-e.x0;let r;r=!1!==l.showValues&&e.value?n-10-30-10-6:n-6-6;const s=Math.max(15,r),o=t.node();if(o.getComputedTextLength()>s){const e="...";let n=a;for(;n.length>0;){if(n=a.substring(0,n.length-1),0===n.length){t.text(e),o.getComputedTextLength()>s&&t.text("");break}if(t.text(n+e),o.getComputedTextLength()<=s)break}}}),!1!==l.showValues&&L.append("text").attr("class","treemapSectionValue").attr("x",e=>e.x1-e.x0-10).attr("y",q/2).attr("text-anchor","end").attr("dominant-baseline","middle").text(e=>e.value?y(e.value):"").attr("font-style","italic").attr("style",e=>{if(0===e.depth)return"display: none;";return"text-anchor: end; dominant-baseline: middle; font-size: 10px; fill:"+S(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"+P({cssCompiledStyles:e.data.cssCompiledStyles}).labelStyles.replace("color:","fill:")});const M=b.leaves(),k=v.selectAll(".treemapLeafGroup").data(M).enter().append("g").attr("class",(e,t)=>`treemapNode treemapLeafGroup leaf${t}${e.data.classSelector?` ${e.data.classSelector}`:""}x`).attr("transform",e=>`translate(${e.x0},${e.y0})`);k.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class","treemapLeaf").attr("fill",e=>e.parent?g(e.parent.data.name):g(e.data.name)).attr("style",e=>P({cssCompiledStyles:e.data.cssCompiledStyles}).nodeStyles).attr("fill-opacity",.3).attr("stroke",e=>e.parent?g(e.parent.data.name):g(e.data.name)).attr("stroke-width",3),k.append("clipPath").attr("id",(e,a)=>`clip-${t}-${a}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-4)).attr("height",e=>Math.max(0,e.y1-e.y0-4)),k.append("text").attr("class","treemapLabel").attr("x",e=>(e.x1-e.x0)/2).attr("y",e=>(e.y1-e.y0)/2).attr("style",e=>"text-anchor: middle; dominant-baseline: middle; font-size: 38px;fill:"+S(e.data.name)+";"+P({cssCompiledStyles:e.data.cssCompiledStyles}).labelStyles.replace("color:","fill:")).attr("clip-path",(e,a)=>`url(#clip-${t}-${a})`).text(e=>e.data.name).each(function(e){const t=j(this),a=e.x1-e.x0,n=e.y1-e.y0,r=t.node(),l=a-8,s=n-8;if(l<10||s<10)return void t.style("display","none");let o=parseInt(t.style("font-size"),10);for(;r.getComputedTextLength()>l&&o>8;)o--,t.style("font-size",`${o}px`);let i=Math.max(6,Math.min(28,Math.round(.6*o))),c=o+2+i;for(;c>s&&o>8&&(o--,i=Math.max(6,Math.min(28,Math.round(.6*o))),!(i<6&&8===o));)t.style("font-size",`${o}px`),c=o+2+i;t.style("font-size",`${o}px`),(r.getComputedTextLength()>l||o<8||s<o)&&t.style("display","none")}),!1!==l.showValues&&k.append("text").attr("class","treemapValue").attr("x",e=>(e.x1-e.x0)/2).attr("y",function(e){return(e.y1-e.y0)/2}).attr("style",e=>"text-anchor: middle; dominant-baseline: hanging; font-size: 28px;fill:"+S(e.data.name)+";"+P({cssCompiledStyles:e.data.cssCompiledStyles}).labelStyles.replace("color:","fill:")).attr("clip-path",(e,a)=>`url(#clip-${t}-${a})`).text(e=>e.value?y(e.value):"").each(function(e){const t=j(this),a=this.parentNode;if(!a)return void t.style("display","none");const n=j(a).select(".treemapLabel");if(n.empty()||"none"===n.style("display"))return void t.style("display","none");const r=parseFloat(n.style("font-size")),l=Math.max(6,Math.min(28,Math.round(.6*r)));t.style("font-size",`${l}px`);const s=(e.y1-e.y0)/2+r/2+2;t.attr("y",s);const o=e.x1-e.x0,i=e.y1-e.y0-4,c=o-8;t.node().getComputedTextLength()>c||s+l>i||l<6?t.style("display","none"):t.style("display",null)});const T=l.diagramPadding??8;be(p,T,"flowchart",l?.useMaxWidth||!1)},"draw"),at=w(function(e,t){return t.db.getClasses()},"getClasses"),nt={draw:tt,getClasses:at},lt={sectionStrokeColor:"black",sectionStrokeWidth:"1",sectionFillColor:"#efefef",leafStrokeColor:"black",leafStrokeWidth:"1",leafFillColor:"#efefef",labelColor:"black",labelFontSize:"12px",valueFontSize:"10px",valueColor:"black",titleColor:"black",titleFontSize:"14px"},rt=w(({treemap:e}={})=>{const t=ee(lt,e);return`\n  .treemapNode.section {\n    stroke: ${t.sectionStrokeColor};\n    stroke-width: ${t.sectionStrokeWidth};\n    fill: ${t.sectionFillColor};\n  }\n  .treemapNode.leaf {\n    stroke: ${t.leafStrokeColor};\n    stroke-width: ${t.leafStrokeWidth};\n    fill: ${t.leafFillColor};\n  }\n  .treemapLabel {\n    fill: ${t.labelColor};\n    font-size: ${t.labelFontSize};\n  }\n  .treemapValue {\n    fill: ${t.valueColor};\n    font-size: ${t.valueFontSize};\n  }\n  .treemapTitle {\n    fill: ${t.titleColor};\n    font-size: ${t.titleFontSize};\n  }\n  `},"getStyles"),st=rt,vt={parser:le,get db(){return new ae},renderer:nt,styles:st};export{vt as diagram};